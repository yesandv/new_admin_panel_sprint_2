# –ü—Ä–æ–µ–∫—Ç–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ: Docker-compose

–ü—Ä–∏—Å—Ç—É–ø–∏–º –∫ —É–ª—É—á—à–µ–Ω–∏—é —Å–µ—Ä–≤–∏—Å–∞ –≤ –æ–±–ª–∞—Å—Ç–∏ DevOps. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã ‚Äî Django, Nginx –∏ Postgresql ‚Äî —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º docker-compose.

–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –º—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –ø—Ä–æ–µ–∫—Ç, –≥–¥–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å–≤—è–∑–∫–∏ Django + uWSGI + Nginx + Docker. –í—ã –µ–≥–æ –Ω–∞–π–¥–µ—Ç–µ –≤ —Å–≤–æ–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤ –ø–∞–ø–∫–µ `docker_compose/simple_project`.

–°–∞–º–∞ –∑–∞–≥–æ—Ç–æ–≤–∫–∞ —É–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–¥–º–∏–Ω–∫—É. –û–¥–Ω–∞–∫–æ —Å—Ç–∞—Ç–∏–∫–∞ –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è, –º–∏–≥—Ä–∞—Ü–∏–π –Ω–µ—Ç, –∫–æ–Ω—Ñ–∏–≥–∏ Nginx, uWSGI –∏ Docker, –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–∏–¥—ë—Ç—Å—è –ø–æ–¥–ø—Ä–∞–≤–∏—Ç—å.

–ï—Å–ª–∏ –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ, —á—Ç–æ –≤—Å—ë –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ-–¥—Ä—É–≥–æ–º—É, —Å–º–µ–ª–æ –º–µ–Ω—è–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞.

**–ü–µ—Ä–µ–¥ —Å–¥–∞—á–µ–π –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Ä–µ–≤—å—é, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ –Ω–∏–∂–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ —à–∞–≥–∏:**

- –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, —Ñ–∞–π–ª `docker_compose/simple_project/app/Dockerfile` –¥–ª—è Django. –í –Ω–µ–º, –∫–∞–∫ –º–∏–Ω–∏–º—É–º, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–±–æ—Ä —Å—Ç–∞—Ç–∏–∫–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `python manage.py collectstatic --no-input`. –¢–∞–∫ –∂–µ –º–æ–∂–Ω–æ –ø—Ä–æ–¥—É–º–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–ª–∏ –¥–∞–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π.
- –î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Nginx –º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞—Ä–∞–±–æ—Ç–∫–∞–º–∏ –∏–∑ —ç—Ç–æ–π —Ç–µ–º—ã, –Ω–æ —Ä–µ–≤—å—é–µ—Ä—ã –±—É–¥—É—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –≤–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ. –ü–µ—Ä–µ–¥ —Å–¥–∞—á–µ–π –ø—Ä–æ–µ–∫—Ç–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ.
- –£–±–µ—Ä–∏—Ç–µ –≤–µ—Ä—Å–∏—é Nginx –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤. –í–µ—Ä—Å–∏–∏ –ª—é–±–æ–≥–æ –ü–û –ª—É—á—à–µ —Å–∫—Ä—ã–≤–∞—Ç—å –æ—Ç –ø–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –≥–ª–∞–∑, —á—Ç–æ–±—ã –≤–∞—à—É –∞–¥–º–∏–Ω–∫—É —Å–ª—É—á–∞–π–Ω–æ –Ω–µ –≤–∑–ª–æ–º–∞–ª–∏. –ù–∞–π–¥–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –£–±–µ–¥–∏—Ç—å—Å—è –≤ —ç—Ç–æ–º –º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é ¬´–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞¬ª –≤ –±—Ä–∞—É–∑–µ—Ä–µ.
- –û—Ç–¥–∞–≤–∞–π—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã Django —á–µ—Ä–µ–∑ Nginx, —á—Ç–æ–±—ã –Ω–µ –Ω–∞–≥—Ä—É–∂–∞—Ç—å —Å–µ—Ä–≤–∏—Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏. –ü–µ—Ä–µ–ø–∏—à–∏—Ç–µ `location` —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `/admin` —à–ª–∏ –±–µ–∑ –ø–æ–∏—Å–∫–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –¢–æ –µ—Å—Ç—å, –º–∏–Ω—É—è –¥–∏—Ä–µ–∫—Ç–∏–≤—É `try_files $uri @backend;`.
- –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ: —Å–±–æ—Ä —Å—Ç–∞—Ç–∏–∫–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Å Django –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, –∞ –æ—Ç–¥–∞–≤–∞—Ç—å –µ–µ –±—É–¥–µ—Ç Nginx. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ Nginx –¥–æ–ª–∂–µ–Ω –∫–∞–∫–∏–º-—Ç–æ –æ–±—Ä–∞–∑–æ–º –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–∏–º —Ñ–∞–π–ª–∞–º. –ú—ã –≤–∞–º —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ–∫—Ü–∏—é `volumes` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –æ–±–æ–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∫ —ç—Ç–∏–º —Ñ–∞–π–ª–∞–º.
- –í `docker-compose.yml` –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é `- ./database_dump.sql:/docker-entrypoint-initdb.d/init.sql` –≤ —Å–µ—Ä–≤–∏—Å–µ `theatre-db`. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã –∑–∞–ª–∏–≤–∞–µ–º –¥–∞–º–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ postgres. –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏, –¥–∞–±—ã –≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –Ω–µ –±—ã–ª–æ –ø—É—Å—Ç–æ. –í—ã –º–æ–∂–µ—Ç–µ —É–±—Ä–∞—Ç—å —ç—Ç—É —Å—Ç—Ä–æ–∫—É, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç—É—é –∞–¥–º–∏–Ω–∫—É. 
- –í–∞–∂–Ω–æ! –°–µ—Ä–≤–∏—Å `theatre-db` –≤ —Ç–µ–∫—É—â–µ–º –≤–∏–¥–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ –±—É–¥–µ—Ç. –≠—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL –∏ –ø–æ–ª–Ω–æ–µ –µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—Å—Ç–∞–µ—Ç—Å—è –∑–∞ –≤–∞–º–∏.
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–±—è. –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `docker compose up -d` –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost/admin/`, –¥–ª—è –≤—Ö–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–≥–∏–Ω `admin` –∏ –ø–∞—Ä–æ–ª—å `123123` (–µ—Å–ª–∏ –≤—ã –∑–∞–ª–∏–≤–∞–µ—Ç–µ database_dump.sql –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ, –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ). –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

![image](django_example.png)

–ï—Å–ª–∏ –≤–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫ –∂–µ, –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, –≤—ã —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å üéâ

**–ü–æ–¥—Å–∫–∞–∑–∫–∏ –∏ —Å–æ–≤–µ—Ç—ã:**

- –¢–µ–æ—Ä–∏–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è. –ï—Å–ª–∏ —É –≤–∞—Å –ø–æ—è–≤—è—Ç—Å—è –∫–∞–∫–∏–µ-—Ç–æ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º, –∏—â–∏—Ç–µ –æ—Ç–≤–µ—Ç—ã [–≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://nginx.org/ru/){target="_blank"}.
- –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –ø—Ä–æ `/admin` –Ω—É–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Ä—è–¥–æ–∫ –ø–æ–∏—Å–∫–∞ `location`.
- –î–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ç–∞—Ç–∏–∫–æ–π –Ω—É–∂–Ω–æ –ø–æ–¥—É–º–∞—Ç—å, –∫–∞–∫ –∑–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å Nginx.
- –î–ª—è –∑–∞–¥–∞–Ω–∏—è –¥–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è.
- –ü—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ docker-compose –≤–∞–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø—É—Ç–∏ –¥–æ –ø–∞–ø–æ–∫. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º —Å–≤—è–∑–∞–Ω–Ω–æ –∏–º–µ–Ω–Ω–æ —Å —ç—Ç–∏–º.

